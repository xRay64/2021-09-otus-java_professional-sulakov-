## Определение нужного размера хипа
### Цель:
на примере простого приложения понять какое влияние оказывают сборщики мусора  
Есть готовое приложение (модуль homework)  
Запустите его с размером хипа 256 Мб и посмотрите в логе время выполнения.  

Пример вывода:  
spend msec:18284, sec:18  

Увеличьте размер хипа до 2Гб, замерьте время выполнения.   
Результаты запусков записывайте в таблицу.  
Определите оптимальный размер хипа, т.е. размер, превышение которого,  
не приводит к сокращению времени выполнения приложения.  
Оптимизируйте работу приложения.  
Т.е. не меняя логики работы, сделайте так, чтобы приложение работало быстро с минимальным хипом.  
Повторите измерения времени выполнения программы для тех же значений размера хипа.  

### Тестовые запуски
Характеристики тестового ПК: MBP Apple M1 with 16GB of unified memory  

Размер heap|Время выполнения
|---|---|
256|Тест не стартует. Судя по heapdaump в 256мб влезает только 6_153_400 инстансов объекта Data. Если уменьшить условие очистки переменной listValues с 6_600_000 на 6_153_400 тест проходит, время выполнения составит: spend msec:15094, sec:15
512|spend msec:11788, sec:11
768|spend msec:11484, sec:11
896|spend msec:10942, sec:10
1024 - оптимальное значение|spend msec:10735, sec:10
1280|spend msec:10958, sec:10
1536|spend msec:10851, sec:10
1792|spend msec:11010, sec:11
2048|spend msec:11634, sec:11

#### -XX:+UseParallelGC
Размер heap|Время выполнения
|---|---|
256|Тест не стартует. Судя по heapdaump в 256мб влезает только 5_748_408 инстансов объекта Data. Если уменьшить условие очистки переменной listValues с 6_600_000 на 5_748_408 тест проходит, время выполнения составит: spend msec:136171, sec:136
512|spend msec:22060, sec:22
768|spend msec:16835, sec:16
896|spend msec:15672, sec:15
1024|spend msec:14264, sec:14
1280|spend msec:13277, sec:13
1536|spend msec:12687, sec:12
1792|spend msec:11045, sec:11
2048|spend msec:10937, sec:10
2560|spend msec:8661, sec:8
3075|spend msec:7024, sec:7
4096|spend msec:6299, sec:6

#### -XX:+UnlockExperimentalVMOptions -XX:+UseZGC
Размер heap|Время выполнения
|---|---|
256|Тест не стартует. Судя по heapdaump в 256мб влезает только 5_248_143 инстансов объекта Data. Если уменьшить условие очистки переменной listValues с 6_600_000 на 5_248_143 тест проходит, время выполнения составит:spend msec:43193, sec:43
512|spend msec:12655, sec:12
768|spend msec:8705, sec:8
896|spend msec:6778, sec:6
1024|spend msec:5549, sec:5
1280|spend msec:5676, sec:5
1536|spend msec:5385, sec:5
1792|spend msec:4694, sec:4
2048|spend msec:4479, sec:4
2560|spend msec:4629, sec:4

### Итоги тестирования
Быстрее всего приложениее работает с ZGC, но так как он экспериментальный в проде использовать его я бы не стал.
Я бы использовал дефолтный GC Z1 с размером хипа 512МБ. С 1024МБ работает быстрее, но "выигрыш" в одну секунду, на мой взгляд, не стоит двукратного увеличения памяти.

#### После замены обертки на примитив
Размер heap|Время выполнения
|---|---|
256|spend msec:2187, sec:2
512 - 1024 |spend msec:1500 - 1600, sec:1

